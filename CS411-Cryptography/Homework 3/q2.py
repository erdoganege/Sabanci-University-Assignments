# -*- coding: utf-8 -*-
"""
Created on Fri Nov 26 01:19:43 2021

@author: user
"""
import math
import random
import warnings
import sympy

def phi(n):
    amount = 0
    for k in range(1, n + 1):
        if math.gcd(n, k) == 1:
            amount += 1
    return amount

def gcd(a, b):
    """Calculate the Greatest Common Divisor of a and b.

    Unless b==0, the result will have the same sign as b (so that when
    b is divided by it, the result comes out positive).
    """
    while b:
        a, b = b, a%b
    return a

def egcd(a, b):
    x,y, u,v = 0,1, 1,0
    while a != 0:
        q, r = b//a, b%a
        m, n = x-u*q, y-v*q
        b,a, x,y, u,v = a,r, u,v, m,n
    gcd = b
    return gcd, x, y

def modinv(a, m):
    if a < 0:
        a = m+a
    gcd, x, y = egcd(a, m)
    if gcd != 1:
        return None  # modular inverse does not exist
    else:
        return x % m

n = 18016967477268905563885869924237258318694694336616829663559951667154254153505669072366238177473263440558000492991536372537213283988529484711229893441507071803749799498790105702483444536003988132660586950451568921485304029859205942961337503869882361605623121993326145107472663215509236908594241726651797652048440841487616622227088039786300710301275956804277343341414737489026770368303573369162349860942860905825794820151838964069214466547295717749202921921883501704394777572542253453842979793225488828952233024252195973191246052177620709124352392865018938598582474975839794084019278727267278105611462802519248548604231
e = 65537

cp = 9867820160500048255431638927950294442888857452802017356453505416310091808006605145856145463743074142573121199571883303687134683915355293283057054339224186575708497167622949063289002891633194069320568407106537223864821184080451890859088268474826663269116716637324503991543330462567876735295609164238294589854178644950695259853710908316805874396069515981835223630389015856509379364269334778716357415239439881588371400196355352989896622297506378215875700303395349554326099965938575348087963277773681266558110800853826756458146115162775042378082518987198719244527931248529407936517480053439914000262764515874170885567089
cq = 14048534465323230545325354135779335373464409479622130604221246300848686788914221027620809648332832957010531559728588150066265908663526139844306737776707609375722715383010693830027879879337369996602006590945672203979052485220246619624725419251173989782594643346471157752575503977729450420254475672606438870084069644514973475243788574248080622778361942012108616350667689291762507592733743801333017344651751499710647047542569741531303356891214062815518816727003969643882074715733945650194347254192244884148448163326582044881804918361223903654789076948440449087391682096234090950225916257119515328501420323582955047875300
cm = 5310140768263889112686766982663485232724147322779548078336689719623100738344476071783487189533703110721280321221697563144942842042881171904224385107645132790162181233375357861709728095507173847988163917175814859755934121945906829725954188639886204218206679347637378077917048385488686117395519692997296468695861765637450771729243711977287157170827507271298730049110587320022257849845106129870227608995699650687879819478556102994986257728139323444273420364374072371315966355286935606776340869423866064535925527997277884492246490694288615200901115911705053893536184781927590935953156270349338459654278881122216658517446

p = gcd(cp, n)
q = gcd(cq, n)

phi_n = (p-1)*(q-1)
d = modinv(e, phi_n)
print("p:", p)
print("q:", q)
print("d:", d)


m_ = pow(cm,d,n)
print("\n")
print(m_.to_bytes((m_.bit_length() + 7) // 8, 'big'))

print("\nReversed?")
print(m_.to_bytes((m_.bit_length() + 7) // 8, 'big')[::-1])






